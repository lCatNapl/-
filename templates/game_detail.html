game_detail
{% extends "base.html" %}

{% block title %}{{ game.title }} - –£–∑–Ω–∞–≤–∞–π–∫–∏–Ω{% endblock %}

{% block content %}
<div class="game-detail-container">
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="game-main-info">
        <div class="game-visual">
            {% if current_user.is_authenticated and current_user.subscription_type == 'premium' and game.image_premium_3d %}
                <div class="premium-3d-viewer">
                    <div class="threejs-canvas" data-model="{{ game.image_premium_3d }}">
                        <div class="loading-3d">
                            <i class="fas fa-cube fa-spin"></i>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ 3D –º–æ–¥–µ–ª–∏...</p>
                        </div>
                    </div>
                    <div class="viewer-controls">
                        <button class="control-btn" data-action="rotate"><i class="fas fa-arrows-alt"></i></button>
                        <button class="control-btn" data-action="zoom"><i class="fas fa-search-plus"></i></button>
                    </div>
                </div>
            {% elif current_user.is_authenticated and current_user.subscription_type in ['vip', 'premium'] and game.image_vip %}
                <div class="vip-image-container">
                    <img src="{{ game.image_vip }}" alt="{{ game.title }}" class="main-image">
                    <div class="vip-exclusive">VIP –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
                </div>
            {% else %}
                <img src="{{ game.image_start or '/static/images/default-game.jpg' }}" 
                     alt="{{ game.title }}" class="main-image">
            {% endif %}
        </div>
        
        <div class="game-meta">
            <h1>{{ game.title }}</h1>
            
            <div class="game-rating">
                <div class="stars" style="--rating: {{ game.rating / 5 }}">
                    ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ
                </div>
                <span class="rating-number">{{ "%.1f"|format(game.rating) }}/5</span>
            </div>
            
            <div class="game-tags">
                <span class="category-badge category-{{ game.category }}">{{ game.category }}</span>
                {% if game.is_featured %}
                    <span class="featured-tag">‚≠ê –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º</span>
                {% endif %}
                {% if current_user.is_authenticated and current_user.subscription_type != 'start' %}
                    <span class="subscription-tag status-{{ current_user.subscription_type }}">
                        {{ current_user.subscription_type.upper() }}
                    </span>
                {% endif %}
            </div>
            
            <div class="game-actions">
                <button class="btn btn-primary btn-large play-btn">
                    <i class="fas fa-play"></i> –ò–≥—Ä–∞—Ç—å –æ–Ω–ª–∞–π–Ω
                </button>
                <button class="btn-favorite" data-game-id="{{ game.id }}">
                    <i class="far fa-heart"></i> –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                </button>
                <button class="btn-share">
                    <i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                </button>
            </div>
        </div>
    </div>

    <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
    <div class="game-description">
        <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
        <div class="description-content">
            {% if current_user.is_authenticated %}
                {{ game.get_description(current_user.subscription_type)|safe }}
            {% else %}
                {{ game.get_description('start')|safe }}
            {% endif %}
            
            {% if current_user.is_authenticated and current_user.subscription_type != 'premium' and game.image_premium_3d %}
                <div class="upgrade-hint">
                    <i class="fas fa-gem"></i>
                    <p>üî• Premium –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç 3D –º–æ–¥–µ–ª—å —ç—Ç–æ–π –∏–≥—Ä—ã!</p>
                    <a href="{{ url_for('profile') }}" class="btn btn-premium">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ Premium</a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="game-details">
        <div class="details-grid">
            <div class="detail-card">
                <h4><i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                <ul>
                    <li><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ game.category }}</li>
                    <li><strong>–†–µ–π—Ç–∏–Ω–≥:</strong> {{ "%.1f"|format(game.rating) }}/5</li>
                    <li><strong>–°—Ç–∞—Ç—É—Å:</strong> {% if game.is_featured %}–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è{% else %}–û–±—ã—á–Ω–∞—è{% endif %}</li>
                </ul>
            </div>
            
            {% if current_user.is_authenticated %}
            <div class="detail-card">
                <h4><i class="fas fa-star"></i> –¢–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞</h4>
                <ul>
                    <li><strong>–ü–æ–¥–ø–∏—Å–∫–∞:</strong> {{ current_user.subscription_type.upper() }}</li>
                    <li><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</strong> 
                        {% if current_user.subscription_type == 'premium' and game.image_premium_3d %}3D{% 
                        elif current_user.subscription_type in ['vip', 'premium'] and game.image_vip %}VIP{%
                        else %}–°—Ç–∞–Ω–¥–∞—Ä—Ç{% endif %}</li>
                    <li><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> {{ game.get_description(current_user.subscription_type)|wordcount }} —Å–ª–æ–≤</li>
                </ul>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ö–Ω–æ–ø–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
    document.querySelector('.btn-favorite').addEventListener('click', function() {
        const icon = this.querySelector('i');
        if (icon.classList.contains('far')) {
            icon.classList.remove('far');
            icon.classList.add('fas');
            icon.style.color = '#E74C3C';
        } else {
            icon.classList.remove('fas');
            icon.classList.add('far');
            icon.style.color = '';
        }
    });

    // –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è
    document.querySelector('.btn-share').addEventListener('click', function() {
        if (navigator.share) {
            navigator.share({
                title: '{{ game.title }} - –£–∑–Ω–∞–≤–∞–π–∫–∏–Ω',
                url: window.location.href
            });
        } else {
            navigator.clipboard.writeText(window.location.href);
            alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
        }
    });

    // 3D –ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫ (–∑–∞–≥–ª—É—à–∫–∞)
    const threejsCanvas = document.querySelector('.threejs-canvas');
    if (threejsCanvas) {
        // –ó–¥–µ—Å—å –±—É–¥–µ—Ç Three.js –∫–æ–¥ –¥–ª—è 3D –º–æ–¥–µ–ª–µ–π
        console.log('Premium 3D viewer ready');
    }
});
</script>
{% endblock %}
